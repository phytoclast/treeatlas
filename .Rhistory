"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
scale_x_continuous(name= "Minimum Growing Season Temperature", breaks=seq(0, 36, by = 2))+
scale_y_continuous(name= "Minnimum Annual Extreme Low", breaks=seq(-65, 5, by = 5))
ggplot() +
geom_boxplot(data = TreeClimcut,
mapping = aes(x = cluster, y = Tgs_min, fill=cluster, color=cluster),size=1, alpha=0.5)+
scale_fill_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
scale_color_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
scale_y_continuous(name= "Minimum Growing Season Temperature", breaks=seq(0, 36, by = 2))
#scale_y_continuous(name= "Minnimum Annual Extreme Low", breaks=seq(-65, 5, by = 5))
ggplot() +
geom_boxplot(data = TreeClimcut,
mapping = aes(x = cluster, y = Tclx_min, fill=cluster, color=cluster),size=1, alpha=0.5)+
scale_fill_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
scale_color_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
#scale_y_continuous(name= "Minimum Growing Season Temperature", breaks=seq(0, 36, by = 2))
scale_y_continuous(name= "Minnimum Annual Extreme Low", breaks=seq(-65, 5, by = 5))
View(TreeClimcut)
cuttree <- as.data.frame(cutree(clust,3))
cuttree$file <- rownames(cuttree)
colnames(cuttree) <- c('cluster', 'file')
TreeClimcut <- merge(TreeClim, cuttree, by='file')
TreeClimcut$cluster <- as.character(TreeClimcut$cluster)
ggplot() +
geom_density2d(data = TreeClimcut,
mapping = aes(x = Tgs_min, y = Tclx_min, fill=cluster, color=cluster),size=1, alpha=0.8)+
geom_point(data = TreeClimcut,
mapping = aes(x = Tgs_min, y = Tclx_min, fill=cluster, color=cluster),size=1, alpha=0.8)+
scale_fill_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
scale_color_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
scale_x_continuous(name= "Minimum Growing Season Temperature", breaks=seq(0, 36, by = 2))+
scale_y_continuous(name= "Minnimum Annual Extreme Low", breaks=seq(-65, 5, by = 5))
ggplot() +
geom_boxplot(data = TreeClimcut,
mapping = aes(x = cluster, y = Tgs_min, fill=cluster, color=cluster),size=1, alpha=0.5)+
scale_fill_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
scale_color_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
scale_y_continuous(name= "Minimum Growing Season Temperature", breaks=seq(0, 36, by = 2))
#scale_y_continuous(name= "Minnimum Annual Extreme Low", breaks=seq(-65, 5, by = 5))
ggplot() +
geom_boxplot(data = TreeClimcut,
mapping = aes(x = cluster, y = Tclx_min, fill=cluster, color=cluster),size=1, alpha=0.5)+
scale_fill_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
scale_color_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
#scale_y_continuous(name= "Minimum Growing Season Temperature", breaks=seq(0, 36, by = 2))
scale_y_continuous(name= "Minnimum Annual Extreme Low", breaks=seq(-65, 5, by = 5))
cuttree <- as.data.frame(cutree(clust,4))
cuttree$file <- rownames(cuttree)
colnames(cuttree) <- c('cluster', 'file')
TreeClimcut <- merge(TreeClim, cuttree, by='file')
TreeClimcut$cluster <- as.character(TreeClimcut$cluster)
ggplot() +
geom_density2d(data = TreeClimcut,
mapping = aes(x = Tgs_min, y = Tclx_min, fill=cluster, color=cluster),size=1, alpha=0.8)+
geom_point(data = TreeClimcut,
mapping = aes(x = Tgs_min, y = Tclx_min, fill=cluster, color=cluster),size=1, alpha=0.8)+
scale_fill_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
scale_color_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
scale_x_continuous(name= "Minimum Growing Season Temperature", breaks=seq(0, 36, by = 2))+
scale_y_continuous(name= "Minnimum Annual Extreme Low", breaks=seq(-65, 5, by = 5))
ggplot() +
geom_boxplot(data = TreeClimcut,
mapping = aes(x = cluster, y = Tgs_min, fill=cluster, color=cluster),size=1, alpha=0.5)+
scale_fill_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
scale_color_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
scale_y_continuous(name= "Minimum Growing Season Temperature", breaks=seq(0, 36, by = 2))
#scale_y_continuous(name= "Minnimum Annual Extreme Low", breaks=seq(-65, 5, by = 5))
ggplot() +
geom_boxplot(data = TreeClimcut,
mapping = aes(x = cluster, y = Tclx_min, fill=cluster, color=cluster),size=1, alpha=0.5)+
scale_fill_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
scale_color_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
#scale_y_continuous(name= "Minimum Growing Season Temperature", breaks=seq(0, 36, by = 2))
scale_y_continuous(name= "Minnimum Annual Extreme Low", breaks=seq(-65, 5, by = 5))
cuttree <- as.data.frame(cutree(clust,5))
cuttree$file <- rownames(cuttree)
colnames(cuttree) <- c('cluster', 'file')
TreeClimcut <- merge(TreeClim, cuttree, by='file')
TreeClimcut$cluster <- as.character(TreeClimcut$cluster)
ggplot() +
geom_density2d(data = TreeClimcut,
mapping = aes(x = Tgs_min, y = Tclx_min, fill=cluster, color=cluster),size=1, alpha=0.8)+
geom_point(data = TreeClimcut,
mapping = aes(x = Tgs_min, y = Tclx_min, fill=cluster, color=cluster),size=1, alpha=0.8)+
scale_fill_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
scale_color_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
scale_x_continuous(name= "Minimum Growing Season Temperature", breaks=seq(0, 36, by = 2))+
scale_y_continuous(name= "Minnimum Annual Extreme Low", breaks=seq(-65, 5, by = 5))
ggplot() +
geom_boxplot(data = TreeClimcut,
mapping = aes(x = cluster, y = Tgs_min, fill=cluster, color=cluster),size=1, alpha=0.5)+
scale_fill_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
scale_color_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
scale_y_continuous(name= "Minimum Growing Season Temperature", breaks=seq(0, 36, by = 2))
#scale_y_continuous(name= "Minnimum Annual Extreme Low", breaks=seq(-65, 5, by = 5))
ggplot() +
geom_boxplot(data = TreeClimcut,
mapping = aes(x = cluster, y = Tclx_min, fill=cluster, color=cluster),size=1, alpha=0.5)+
scale_fill_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
scale_color_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
#scale_y_continuous(name= "Minimum Growing Season Temperature", breaks=seq(0, 36, by = 2))
scale_y_continuous(name= "Minnimum Annual Extreme Low", breaks=seq(-65, 5, by = 5))
ggplot() +
geom_boxplot(data = TreeClimcut,
mapping = aes(x = cluster, y = Tgs_max, fill=cluster, color=cluster),size=1, alpha=0.5)+
scale_fill_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
scale_color_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
scale_y_continuous(name= "Maximum Growing Season Temperature", breaks=seq(0, 36, by = 2))
#scale_y_continuous(name= "Minnimum Annual Extreme Low", breaks=seq(-65, 5, by = 5))
library(rpart)
rpart(cluster~ Tclx_min +Tclx_max +Tgs_min +Tgs_max, data= TreeClimcut, method = "class")
library(rpart.plot)
rpart.plot(model)
model <- rpart(cluster~ Tclx_min +Tclx_max +Tgs_min +Tgs_max, data= TreeClimcut, method = "class", maxdepth = 4)
rpart.plot(model)
rpart.plot(model, extra=108)
aggregate(TreeClimcut[,c('Tclx_max','Tclx_min','Tgs_max','Tgs_min')], by=list(TreeClimcut$cluster), FUN='median')
View(TreeClimcut)
View(TreeClimcut)
aggregate(TreeClimcut[,c('Tclx_max','Tclx_min','Tgs_max','Tgs_min')], by=list(TreeClimcut$cluster), FUN='stdev')
aggregate(TreeClimcut[,c('Tclx_max','Tclx_min','Tgs_max','Tgs_min')], by=list(TreeClimcut$cluster), FUN='sd')
st(TreeClimcut[,c('Tclx_max','Tclx_min','Tgs_max','Tgs_min')])
sd(TreeClimcut[,c('Tclx_max','Tclx_min','Tgs_max','Tgs_min')])
ggplot() +
geom_boxplot(data = TreeClimcut,
mapping = aes(x = cluster, y = Tgs_max, fill=cluster, color=cluster),size=1, alpha=0.5)+
geom_boxplot(data = TreeClimcut,
mapping = aes(x = cluster, y = Tgs_min, fill=cluster, color=cluster),size=1, alpha=0.5)+
scale_fill_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
scale_color_manual("Legend", values = c("1" = "red",
"2" = "green",
"3" = "blue",
"4" = "orange",
"5" = "yellow",
"6" = "purple",
"7" = "pink"))+
scale_y_continuous(name= "Maximum Growing Season Temperature", breaks=seq(0, 36, by = 2))
#scale_y_continuous(name= "Minnimum Annual Extreme Low", breaks=seq(-65, 5, by = 5))
View(treelist)
View(TreeClimcut)
library(sf)
library(raster)
library(rgdal)
library(velox)
library(lattice)
library(dplyr)
library(ggplot2)
treelist <- read.delim('treefiles.txt')
forms <- read.delim('data/NorthAmericaGrowthHabits20180924.txt', encoding="Latin1")
syns <- read.delim('data/BONAPGRIN_NAMES.txt', encoding="UTF-8")
colnames(syns) <- c("Binomial","Taxon","B_Taxon","B_Binomial","G_Taxon","G_Binomial")
formsyns <- merge(syns, forms, by.x='Taxon', by.y='Scientific.Name')
formsyns <- unique(formsyns[!is.na(formsyns$B_Binomial) & !is.na(formsyns$HabitSymbol)& !formsyns$B_Binomial %in% "", c('HabitSymbol','B_Binomial')])
treelistsyns <- merge(treelist, syns, by.x='Latin.Name', by.y='Taxon', all.x=TRUE)
treelistsyns <- unique(treelistsyns[!is.na(treelistsyns$B_Binomial),c('name','B_Binomial')])
treelistforms <- merge(treelistsyns, formsyns, by='B_Binomial', all.x=TRUE)
BE <- as.character(unique(treelistforms[grepl('BE', treelistforms$HabitSymbol),'name']))
PALM <- as.character(unique(treelistforms[grepl('P', treelistforms$HabitSymbol),'name']))
BD <- as.character(unique(treelistforms[grepl('BD', treelistforms$HabitSymbol),'name']))
NE <- as.character(unique(treelistforms[grepl('NE', treelistforms$HabitSymbol)|grepl('ND', treelistforms$HabitSymbol),'name']))
SU <- as.character(unique(treelistforms[grepl('U', treelistforms$HabitSymbol),'name']))
TreeClim <- readRDS('data/TreeClim.RDS')
TreeClim <- unique(TreeClim[2:nrow(TreeClim),])
rownames(TreeClim) <- TreeClim$file
BroadEvergreens <- unique(TreeClim[TreeClim$file %in% BE,])
Monocot <- unique(TreeClim[TreeClim$file %in% PALM,])
Succulent <- unique(TreeClim[TreeClim$file %in% SU,])
BroadDeciduous <- unique(TreeClim[TreeClim$file %in% BD,])
Needle <- unique(TreeClim[TreeClim$file %in% NE,])
View(Needle)
View(BroadDeciduous)
View(BroadEvergreens)
library(sf)
library(raster)
library(rgdal)
library(velox)
library(lattice)
library(dplyr)
library(ggplot2)
treelist <- read.delim('treefiles.txt')
bt_frost <- read.delim('bt_frost.txt')
forms <- read.delim('data/NorthAmericaGrowthHabits20180924.txt', encoding="Latin1")
syns <- read.delim('data/BONAPGRIN_NAMES.txt', encoding="UTF-8")
colnames(syns) <- c("Binomial","Taxon","B_Taxon","B_Binomial","G_Taxon","G_Binomial")
formsyns <- merge(syns, forms, by.x='Taxon', by.y='Scientific.Name')
formsyns <- unique(formsyns[!is.na(formsyns$B_Binomial) & !is.na(formsyns$HabitSymbol)& !formsyns$B_Binomial %in% "", c('HabitSymbol','B_Binomial')])
treelistsyns <- merge(treelist, syns, by.x='Latin.Name', by.y='Taxon', all.x=TRUE)
treelistsyns <- unique(treelistsyns[!is.na(treelistsyns$B_Binomial),c('name','B_Binomial')])
treelistforms <- merge(treelistsyns, formsyns, by='B_Binomial', all.x=TRUE)
treelist <- read.delim('treefiles2.txt')
bt_frost <- read.delim('bt_frost2.txt')
View(bt_frost)
bt_frost$b01 <- 0
bt_frost$b02 <- 0
bt_frost$b03 <- 0
bt_frost$b04 <- 0
bt_frost$b05 <- 0
bt_frost$b06 <- 0
bt_frost$b07 <- 0
bt_frost$b08 <- 0
bt_frost$b09 <- 0
bt_frost$b10 <- 0
bt_frost$b11 <- 0
bt_frost$b12 <- 0
for (i in 0:11){
bt_frost[,which(colnames(bt_frost)=='b01')+i]  <- bt_frost[,which(colnames(bt_frost)=='t01')+i]*
(bt_frost[,which(colnames(bt_frost)=='t01')+i]>0)*1
}
bt_frost$bl01 <- 0
bt_frost$bl02 <- 0
bt_frost$bl03 <- 0
bt_frost$bl04 <- 0
bt_frost$bl05 <- 0
bt_frost$bl06 <- 0
bt_frost$bl07 <- 0
bt_frost$bl08 <- 0
bt_frost$bl09 <- 0
bt_frost$bl10 <- 0
bt_frost$bl11 <- 0
bt_frost$bl12 <- 0
for (i in 0:11){
bt_frost[,which(colnames(bt_frost)=='bl01')+i]  <- bt_frost[,which(colnames(bt_frost)=='tl01')+i]*
(bt_frost[,which(colnames(bt_frost)=='tl01')+i]>0)*1
}
bt_frost$bt <- apply(bt_frost[,c('b01', 'b02', 'b04', 'b04', 'b05', 'b06', 'b07', 'b08', 'b09', 'b10', 'b11', 'b12')], 1, FUN = mean)
bt_frost$btl <- apply(bt_frost[,c('bl01', 'bl02', 'bl04', 'bl04', 'bl05', 'bl06', 'bl07', 'bl08', 'bl09', 'bl10', 'bl11', 'bl12')], 1, FUN = mean)
cor(bt_frost[,c('Frost50', 'bt0510','tmin','t01','bt','btl')])
bt_frost$gl01 <- 0
bt_frost$gl02 <- 0
bt_frost$gl03 <- 0
bt_frost$gl04 <- 0
bt_frost$gl05 <- 0
bt_frost$gl06 <- 0
bt_frost$gl07 <- 0
bt_frost$gl08 <- 0
bt_frost$gl09 <- 0
bt_frost$gl10 <- 0
bt_frost$gl11 <- 0
bt_frost$gl12 <- 0
for (i in 0:11){
bt_frost[,which(colnames(bt_frost)=='gl01')+i]  <-( bt_frost[,which(colnames(bt_frost)=='tl01')+i]-10)*
(bt_frost[,which(colnames(bt_frost)=='tl01')+i]>10)*1
}
bt_frost$gtl <- apply(bt_frost[,c('gl01', 'gl02', 'gl04', 'gl04', 'gl05', 'gl06', 'gl07', 'gl08', 'gl09', 'gl10', 'gl11', 'gl12')], 1, FUN = mean)
cor(bt_frost[,c('Frost50', 'bt0510','tmin','t01','bt','btl','gtl')])
bt_frost$gdif <- bt_frost$btl - bt_frost$gtl
cor(bt_frost[,c('Frost50', 'bt0510','tmin','t01','bt','btl','gtl','gdif')])
for (i in 0:11){
bt_frost[,which(colnames(bt_frost)=='gl01')+i]  <-( bt_frost[,which(colnames(bt_frost)=='tl01')+i]-5)*
(bt_frost[,which(colnames(bt_frost)=='tl01')+i]>5)*1
}
bt_frost$bt <- apply(bt_frost[,c('b01', 'b02', 'b04', 'b04', 'b05', 'b06', 'b07', 'b08', 'b09', 'b10', 'b11', 'b12')], 1, FUN = mean)
bt_frost$btl <- apply(bt_frost[,c('bl01', 'bl02', 'bl04', 'bl04', 'bl05', 'bl06', 'bl07', 'bl08', 'bl09', 'bl10', 'bl11', 'bl12')], 1, FUN = mean)
bt_frost$gtl <- apply(bt_frost[,c('gl01', 'gl02', 'gl04', 'gl04', 'gl05', 'gl06', 'gl07', 'gl08', 'gl09', 'gl10', 'gl11', 'gl12')], 1, FUN = mean)
bt_frost$gdif <- bt_frost$btl - bt_frost$gtl
cor(bt_frost[,c('Frost50', 'bt0510','tmin','t01','bt','btl','gtl','gdif')])
for (i in 0:11){
bt_frost[,which(colnames(bt_frost)=='gl01')+i]  <-( bt_frost[,which(colnames(bt_frost)=='tl01')+i]-15)*
(bt_frost[,which(colnames(bt_frost)=='tl01')+i]>15)*1
}
bt_frost$bt <- apply(bt_frost[,c('b01', 'b02', 'b04', 'b04', 'b05', 'b06', 'b07', 'b08', 'b09', 'b10', 'b11', 'b12')], 1, FUN = mean)
bt_frost$btl <- apply(bt_frost[,c('bl01', 'bl02', 'bl04', 'bl04', 'bl05', 'bl06', 'bl07', 'bl08', 'bl09', 'bl10', 'bl11', 'bl12')], 1, FUN = mean)
bt_frost$gtl <- apply(bt_frost[,c('gl01', 'gl02', 'gl04', 'gl04', 'gl05', 'gl06', 'gl07', 'gl08', 'gl09', 'gl10', 'gl11', 'gl12')], 1, FUN = mean)
bt_frost$gdif <- bt_frost$btl - bt_frost$gtl
cor(bt_frost[,c('Frost50', 'bt0510','tmin','t01','bt','btl','gtl','gdif')])
for (i in 0:11){
bt_frost[,which(colnames(bt_frost)=='gl01')+i]  <-( bt_frost[,which(colnames(bt_frost)=='tl01')+i]-12)*
(bt_frost[,which(colnames(bt_frost)=='tl01')+i]>12)*1
}
bt_frost$bt <- apply(bt_frost[,c('b01', 'b02', 'b04', 'b04', 'b05', 'b06', 'b07', 'b08', 'b09', 'b10', 'b11', 'b12')], 1, FUN = mean)
bt_frost$btl <- apply(bt_frost[,c('bl01', 'bl02', 'bl04', 'bl04', 'bl05', 'bl06', 'bl07', 'bl08', 'bl09', 'bl10', 'bl11', 'bl12')], 1, FUN = mean)
bt_frost$gtl <- apply(bt_frost[,c('gl01', 'gl02', 'gl04', 'gl04', 'gl05', 'gl06', 'gl07', 'gl08', 'gl09', 'gl10', 'gl11', 'gl12')], 1, FUN = mean)
bt_frost$gdif <- bt_frost$btl - bt_frost$gtl
cor(bt_frost[,c('Frost50', 'bt0510','tmin','t01','bt','btl','gtl','gdif')])
for (i in 0:11){
bt_frost[,which(colnames(bt_frost)=='gl01')+i]  <-( bt_frost[,which(colnames(bt_frost)=='tl01')+i]-9)*
(bt_frost[,which(colnames(bt_frost)=='tl01')+i]>9)*1
}
bt_frost$bt <- apply(bt_frost[,c('b01', 'b02', 'b04', 'b04', 'b05', 'b06', 'b07', 'b08', 'b09', 'b10', 'b11', 'b12')], 1, FUN = mean)
bt_frost$btl <- apply(bt_frost[,c('bl01', 'bl02', 'bl04', 'bl04', 'bl05', 'bl06', 'bl07', 'bl08', 'bl09', 'bl10', 'bl11', 'bl12')], 1, FUN = mean)
bt_frost$gtl <- apply(bt_frost[,c('gl01', 'gl02', 'gl04', 'gl04', 'gl05', 'gl06', 'gl07', 'gl08', 'gl09', 'gl10', 'gl11', 'gl12')], 1, FUN = mean)
bt_frost$gdif <- bt_frost$btl - bt_frost$gtl
cor(bt_frost[,c('Frost50', 'bt0510','tmin','t01','bt','btl','gtl','gdif')])
for (i in 0:11){
bt_frost[,which(colnames(bt_frost)=='gl01')+i]  <-( bt_frost[,which(colnames(bt_frost)=='tl01')+i]-6)*
(bt_frost[,which(colnames(bt_frost)=='tl01')+i]>6)*1
}
bt_frost$bt <- apply(bt_frost[,c('b01', 'b02', 'b04', 'b04', 'b05', 'b06', 'b07', 'b08', 'b09', 'b10', 'b11', 'b12')], 1, FUN = mean)
bt_frost$btl <- apply(bt_frost[,c('bl01', 'bl02', 'bl04', 'bl04', 'bl05', 'bl06', 'bl07', 'bl08', 'bl09', 'bl10', 'bl11', 'bl12')], 1, FUN = mean)
bt_frost$gtl <- apply(bt_frost[,c('gl01', 'gl02', 'gl04', 'gl04', 'gl05', 'gl06', 'gl07', 'gl08', 'gl09', 'gl10', 'gl11', 'gl12')], 1, FUN = mean)
bt_frost$gdif <- bt_frost$btl - bt_frost$gtl
cor(bt_frost[,c('Frost50', 'bt0510','tmin','t01','bt','btl','gtl','gdif')])
for (i in 0:11){
bt_frost[,which(colnames(bt_frost)=='gl01')+i]  <-( bt_frost[,which(colnames(bt_frost)=='tl01')+i]-7)*
(bt_frost[,which(colnames(bt_frost)=='tl01')+i]>7)*1
}
bt_frost$bt <- apply(bt_frost[,c('b01', 'b02', 'b04', 'b04', 'b05', 'b06', 'b07', 'b08', 'b09', 'b10', 'b11', 'b12')], 1, FUN = mean)
bt_frost$btl <- apply(bt_frost[,c('bl01', 'bl02', 'bl04', 'bl04', 'bl05', 'bl06', 'bl07', 'bl08', 'bl09', 'bl10', 'bl11', 'bl12')], 1, FUN = mean)
bt_frost$gtl <- apply(bt_frost[,c('gl01', 'gl02', 'gl04', 'gl04', 'gl05', 'gl06', 'gl07', 'gl08', 'gl09', 'gl10', 'gl11', 'gl12')], 1, FUN = mean)
bt_frost$gdif <- bt_frost$btl - bt_frost$gtl
cor(bt_frost[,c('Frost50', 'bt0510','tmin','t01','bt','btl','gtl','gdif')])
for (i in 0:11){
bt_frost[,which(colnames(bt_frost)=='gl01')+i]  <-( bt_frost[,which(colnames(bt_frost)=='tl01')+i]-8)*
(bt_frost[,which(colnames(bt_frost)=='tl01')+i]>8)*1
}
bt_frost$bt <- apply(bt_frost[,c('b01', 'b02', 'b04', 'b04', 'b05', 'b06', 'b07', 'b08', 'b09', 'b10', 'b11', 'b12')], 1, FUN = mean)
bt_frost$btl <- apply(bt_frost[,c('bl01', 'bl02', 'bl04', 'bl04', 'bl05', 'bl06', 'bl07', 'bl08', 'bl09', 'bl10', 'bl11', 'bl12')], 1, FUN = mean)
bt_frost$gtl <- apply(bt_frost[,c('gl01', 'gl02', 'gl04', 'gl04', 'gl05', 'gl06', 'gl07', 'gl08', 'gl09', 'gl10', 'gl11', 'gl12')], 1, FUN = mean)
bt_frost$gdif <- bt_frost$btl - bt_frost$gtl
cor(bt_frost[,c('Frost50', 'bt0510','tmin','t01','bt','btl','gtl','gdif')])
for (i in 0:11){
bt_frost[,which(colnames(bt_frost)=='gl01')+i]  <-( bt_frost[,which(colnames(bt_frost)=='tl01')+i]-10)*
(bt_frost[,which(colnames(bt_frost)=='tl01')+i]>10)*1
}
bt_frost$bt <- apply(bt_frost[,c('b01', 'b02', 'b04', 'b04', 'b05', 'b06', 'b07', 'b08', 'b09', 'b10', 'b11', 'b12')], 1, FUN = mean)
bt_frost$btl <- apply(bt_frost[,c('bl01', 'bl02', 'bl04', 'bl04', 'bl05', 'bl06', 'bl07', 'bl08', 'bl09', 'bl10', 'bl11', 'bl12')], 1, FUN = mean)
bt_frost$gtl <- apply(bt_frost[,c('gl01', 'gl02', 'gl04', 'gl04', 'gl05', 'gl06', 'gl07', 'gl08', 'gl09', 'gl10', 'gl11', 'gl12')], 1, FUN = mean)
bt_frost$gdif <- bt_frost$btl - bt_frost$gtl
cor(bt_frost[,c('Frost50', 'bt0510','tmin','t01','bt','btl','gtl','gdif')])
model <- glm(Frost50  ~ bt0510+tmin+t01+bt+btl+gtl+gdif, data=bt_frost)
summary(model)
model <- glm(Frost50  ~ bt0510+tmin+t01+bt+btl+gdif, data=bt_frost)
summary(model)
model2 <- lm(Frost50  ~ bt0510+tmin+t01+bt+btl+gdif, data=bt_frost)
summary(model)
model2 <- lm(Frost50  ~ bt0510+tmin+t01+bt+btl+gdif, data=bt_frost)
summary(model)
model <- glm(Frost50  ~ bt0510+tmin+t01+bt+btl+gdif, data=bt_frost)
summary(model)
bt_frost$fit <- predict(model, bt_frost)
model2 <- lm(Frost50  ~ bt0510+tmin+t01+bt+btl+gdif, data=bt_frost)
summary(model2)
model <- glm(Frost50  ~ bt0510+tmin+bt+btl+gdif, data=bt_frost)
summary(model)
model <- glm(Frost50  ~ bt0510+bt+btl+gdif, data=bt_frost)
summary(model)
model <- glm(Frost50  ~ bt0510+bt+gdif, data=bt_frost)
summary(model)
model <- glm(Frost50  ~ bt0510+bt+gdif, data=bt_frost)
summary(model)
bt_frost$fit <- predict(model, bt_frost)
model2 <- glm(Frost50  ~ bt0510+tmin+t01+bt+btl+gdif, data=bt_frost)
summary(model2)
bt_frost$fit2 <- predict(model2, bt_frost)
View(bt_frost)
View(bt_frost)
bt_frostx <- subset(bt_frost, select= -c(10:58))
View(bt_frostx)
colnames(bt_frost)
bt_frostx <- subset(bt_frost, select= c("Station_Name","State","bt0510","tmin","Frost50","Freeze50","t01","fit","fit2"))
View(bt_frostx)
model2 <- glm(Frost50  ~ bt0510+tmin+t01+bt+btl+gdif+Elevation, data=bt_frost)
summary(model2)
model <- glm(Frost50  ~ bt0510+bt+gdif+Elevation, data=bt_frost)
summary(model)
bt_frost$fit <- predict(model, bt_frost)
bt_frostx <- subset(bt_frost, select= c("Station_Name","State","Elevation","bt0510","tmin","Frost50","Freeze50","t01","fit","fit2"))
